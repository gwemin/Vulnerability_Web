import React, {useState,useEffect} from 'react'
import Router from 'components/Router';
import { authService } from 'firebase_config'
import { makeStyles } from '@material-ui/core/styles';
import { CircularProgress } from '@material-ui/core';

  const useStyles = makeStyles((theme) => ({
    lodingtext : {
      left: "50%", 
      position: "absolute", 
      top: "55vh", 
    },
    loding :{
      left: "50%", 
      position: "absolute", 
      top: "50vh", 
    },
  }));

function App() {
  const [init, setInit] = useState(false);
  const [User, SetUser] = useState(null);
  const [isLoggedIn , setIsLoggedIn] = useState(false); 

  useEffect(() => {
    authService.onAuthStateChanged((userobj) => {
      if(userobj){
        setIsLoggedIn(true);
        SetUser(userobj);
      } else{
        setIsLoggedIn(false);
      }
      setInit(true);
    });
  }, []);



  const classes = useStyles();
  return (
      <>
        {init ? <Router User={User} isLoggedIn={isLoggedIn} /> :  
        <div className={classes.root}> 
          <CircularProgress className={classes.loding} /> <br/>
          <h5 className={classes.lodingtext}>로딩중....</h5>
        </div> }
      </>      
    )
}  


  

export default App
